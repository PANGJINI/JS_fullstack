<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì¢…í•© ì‹¤ìŠµ 02</title>
    <style>
        table {
            width: 800px;
            margin: 0 auto;
            border: 1px solid gray;
            border-collapse: collapse;
        }

        td, th {
            border: 1px solid gray;
        }

    </style>
</head>
<body>
    <h3>ğŸ’–ê²Œì‹œê¸€ ë°ì´í„° ê°€ì ¸ì˜¤ê¸° ì‹¤ìŠµ</h3>

    <input type="text" id="inputId" placeholder="userId" value=""/>
    <input type="button" id="searchIdButton" value="ì›í•˜ëŠ” ì•„ì´ë””ë¡œ ê²Œì‹œê¸€ ì°¾ê¸°">
    
    <hr>
    <button id="list-button">ì „ì²´ ê²Œì‹œê¸€ ë³´ê¸°</button>
    
    <hr>
    <div>
        <input type="hidden" id="userId" value="9999">
        <input type="text" id="title" placeholder="title">
        <input type="text" id="content" placeholder="content">
    </div>
    <!-- <div>
        <form act
    </div> -->
    <button id="write-button">ê²Œì‹œê¸€ ì¶”ê°€í•˜ê¸°</button>


    <table class="postTable">
        <thead>
            <tr>
                <th>userId</th>
                <th>postId</th>
                <th>title</th>
                <th>content</th>
            </tr>
        </thead>
        <tbody>

        </tbody>
        
    </table>
</body>
<script src="service02.js"></script>
<script src="layout02.js"></script>
<script>
    // ì „ì²´ ê²Œì‹œê¸€ ë³´ê¸° ë²„íŠ¼
    const listBtn = document.querySelector("button");
    // ê²Œì‹œê¸€ ì¶”ê°€í•˜ê¸° ë²„íŠ¼
    const writeBtn = document.getElementById("write-button");
    // ë°ì´í„°ê°€ ì¶œë ¥ë  ë¶€ë¶„ (tbody)
    const tbody = document.querySelector("table.postTable tbody");

    

    const writeBtnClickEvent = async(e) => {
        // ì‚¬ìš©ì ì…ë ¥ê°’ ê°€ì ¸ì˜¤ê¸°
        const userId = document.getElementById("userId").value;
        const title = document.getElementById("title").value;
        const content = document.getElementById("content").value;

        // ê°ì²´í™” í•˜ê¸°
        const post = {
            userId: userId,
            title: title,
            content: content,
        }

        await postService.create(post);

        await postService.findAll(postLayout.showList);

        // console.log(createPost);

        // const newPost = await postService.create(createdPost, postLayout.showNewPost);
        // const text = await postService.findAll(postLayout.showPost);

        // // ì „ì²´ ê²Œì‹œê¸€ ì¶œë ¥í•˜ê¸°
        // tbody.innerHTML = text;
        // // ë§¨ ë’¤ì— ìƒˆë¡œìš´ ê²Œì‹œê¸€ ì¶œë ¥í•˜ê¸°
        // tbody.innerHTML += newPost;



    }


    // ë¦¬íŒ©í† ë§
    // ì „ì²´ ê²Œì‹œê¸€ ë³´ê¸° ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
    listBtn.addEventListener("click", async (e)=> {
        const text = await postService.findAll(postLayout.showList);
        tbody.innerHTML = text;
        //console.log("efae");
        
    })
    writeBtn.addEventListener("click", writeBtnClickEvent);











    // íšŒì›ì´ ì…ë ¥í•œ idê°’
    const inputId = document.querySelector("input[type=text]");
    // idê°’ìœ¼ë¡œ ê²Œì‹œë¬¼ ê²€ìƒ‰í•˜ê¸° ë²„íŠ¼
    const searchIdButton = document.getElementById("searchIdButton");

    // idê°’ìœ¼ë¡œ ê²Œì‹œë¬¼ ê²€ìƒ‰í•˜ê¸° ì´ë²¤íŠ¸
    searchIdButton.addEventListener("click", async (e) => {

        const tbody = document.querySelector("table.postTable tbody");
        
        const response = await fetch('https://jsonplaceholder.typicode.com/posts', {method: 'get'});
        const posts = await response.json();

        let text = ``;
        const resultById = posts.filter((post) => post.userId==inputId.value)
        console.log(resultById);
        resultById.forEach((data) => {
            text += `
                <tr>
                    <td>${data.userId}</td>
                    <td>${data.id}</td>
                    <td>${data.title}</td>
                    <td>${data.body}</td>
                </tr>
            `
        })
        // ëˆ„ì ëœ íšŒì›ì˜ ì •ë³´ë¥¼ <tbody>ì— ì¶œë ¥í•œë‹¤.
        tbody.innerHTML = text;
    })


    

</script>
</html>